---
title: Electron 初体验
date: 2021-09-10 12:10:00
comments: false
author: 8963
tags:
  - Electron
  - JavaScript
categories:
  - 前端
---



# 创建程序应用

## 安装

```bash
mkdir first_app
cd first_app\
npm init -y
npm install electron -S
```

配置packge.json，启动命令

```json
"scripts": {
	"start":"electron"
},
```

## main.js主进程

`main` 是 Electron 应用程序得入口，运行在一个完整的Node.js环境中

- 控制主进程
- 负责控制您应用的生命周期
- 显示原生界面
- 执行特殊操作并管理渲染器进程

在主进程中创建一个窗口，在窗口中打开一个页面

```javascript
const electron = require("electron");
const app = electron.app;
// 当 Electron 完成初始化时触发
app.on("ready", () => {
  // 创建新窗口
  let mainWindow = new electron.BrowserWindow({
    width: 800,
    height: 300,
  });
  mainWindow.loadFile("./index.html");
});
// 当`ready`事件被激发，打开窗口
app.whenReady().then(() => {
  createWindow();
});
```

`index.html`

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Electron</title>
  </head>
  <body>
    <h1>Hello World</h1>
    <h3>This is my first Electron App</h3>
  </body>
</html>
```

运行

```
npm run start
```

![](https://cdn.jsdelivr.net/gh/K8963/Imageshack@main/blog/202209070816898.png)

## 自动刷新页面

安装插件

```
npm install --save-dev electron-reloader
```

在主进程中引入

```
const reloader = require('electron-reloader')
reloader(module)
```

就可以实现应用自动刷新

## 自定义菜单

### 创建菜单

```javascript
const { Menu, BrowserWindow, app } = require("electron");
// 定义菜单
const template = [
  {
    label: "文件",
    submenu: [
      {
        label: "1",
      },
    ],
  },
  {
    label: "编辑",
    submenu: [
      {
        label: "1",
      },
    ],
  },
];
// 创建菜单
const menu = Menu.buildFromTemplate(template);
// 设置菜单
Menu.setApplicationMenu(menu);
```

![](https://cdn.jsdelivr.net/gh/K8963/Imageshack@main/blog/202209070816496.png)

### 添加菜单事件

```javascript
const template = [
  {
    label: "创建新窗口",
    click() {
      const newWindow = new BrowserWindow({
        width: 300,
        heighr: 300,
      });
      newWindow.loadFile("new.html");
    },
  },
  {
    label: "打开链接",
    click() {
      shell.openExternal(
        "https://www.electronjs.org/docs/tutorial/quick-start"
      );
    },
  },
];
```



![](https://cdn.jsdelivr.net/gh/K8963/Imageshack@main/blog/202209070816706.png)



# 错误记录

安装electro 时，出现

![](https://cdn.jsdelivr.net/gh/K8963/Imageshack@main/blog/202209070817594.png)

百度找到方法说切换到淘宝也失败了，Google了许多方法也都不成功，抱着再试一试的心态又安装几次莫名其妙就成功了，可能是网络的问题

![](https://cdn.jsdelivr.net/gh/K8963/Imageshack@main/blog/202209070817344.png)



